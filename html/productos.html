<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos - Small Dick's Barber</title>
    
    <link rel="stylesheet" href="/css/style.css">
    <style>
        /* Estilo para centrar el botón dentro de la tarjeta del producto */
        .product-card {
            text-align: center;
        }
    </style>
</head>
<body>

    <header>
        <nav>
            <!-- Icono de Menú Hamburguesa -->
            <div id="hamburger-btn">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <!-- Logo Centrado -->
            <a href="/index.html" class="logo">Small Dick's Barber</a> 
            <!-- Espacio a la derecha para el botón del carrito -->
            <div class="nav-placeholder">
                <a href="#" id="cart-btn" class="btn-cita">Carrito (<span id="cart-count">0</span>)</a>
            </div>
        </nav>
    </header>

    <!-- Menú Lateral Desplegable -->
    <div id="side-menu" class="side-nav">
        <a href="#" class="close-side-menu">&times;</a>
        <ul>
            <li><a href="/index.html">Inicio</a></li> 
        </ul>
        <!-- El inicio de sesión se gestiona aquí, pero no se muestra si está el carrito -->
        <div id="auth-container" class="side-menu-auth"></div>
    </div>

    <main>

        <section id="catalogo">
            <h2>Nuestro Catálogo</h2>
            <p class="subtitulo-catalogo">Productos premium para tu cuidado diario.</p>

            <div class="product-grid" id="product-grid">
                <!-- Los productos se cargarán aquí dinámicamente -->
            </div>
        </section>

    </main>

    <footer>
        <p>&copy; 2025 Small Dick's Barber. Todos los derechos reservados.</p>
    </footer>

    <script src="/JS/validaciones.js"></script>
    <script src="/JS/script.js"></script>
    
    <!-- Script para cargar productos dinámicamente desde la API -->
    <script>
        function cargarProductosDinamicamente() {
            fetch('../php/productos_get.php')
                .then(res => res.json())
                .then(productos => {
                    const gridContainer = document.getElementById('product-grid');
                    gridContainer.innerHTML = ''; // Limpiar productos anteriores
                    
                    if (productos.length === 0) {
                        gridContainer.innerHTML = '<p style="grid-column: 1/-1; text-align: center;">No hay productos disponibles</p>';
                        return;
                    }
                    
                    productos.forEach(producto => {
                        const card = document.createElement('div');
                        card.className = 'product-card';
                        card.setAttribute('data-id', producto.id_producto);
                        card.setAttribute('data-name', producto.nombre);
                        card.setAttribute('data-price', producto.precio);
                        card.setAttribute('data-img', '../img/placeholder.svg?height=200&width=200&query=' + encodeURIComponent(producto.nombre));
                        
                        card.innerHTML = `
                            <img src="../img/placeholder.svg?height=200&width=200&query=${encodeURIComponent(producto.nombre)}" alt="${producto.nombre}">
                            <h3>${producto.nombre}</h3>
                            <p>${producto.descripcion || 'Producto de calidad premium'}</p>
                            <span class="precio">$${parseFloat(producto.precio).toFixed(2)}</span>
                            <button class="btn-comprar">Agregar al carrito</button>
                        `;
                        
                        gridContainer.appendChild(card);
                    });
                    
                    // Re-agregar event listeners a los botones después de cargar
                    agregarEventListenersProductos();
                })
                .catch(err => console.error('Error al cargar productos:', err));
        }
        
        // Cargar productos cuando la página carga
        document.addEventListener('DOMContentLoaded', cargarProductosDinamicamente);
        
        // Recargar productos cada 5 segundos para sincronización en tiempo real
        setInterval(cargarProductosDinamicamente, 5000);
    </script>

    <!-- Estructura del Modal del Carrito (Oculto por defecto) -->
    <div id="cart-modal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Carrito de Compras</h2>
            <div id="cart-items-container">
                <!-- Los items del carrito se insertarán aquí -->
            </div>
            <div id="cart-total">
                <!-- El total se mostrará aquí -->
            </div>
            <div id="checkout-options" style="margin-top: 1.5rem; display: flex; flex-wrap: wrap; gap: 1rem; justify-content: center;">
                <button id="pickup-btn" class="btn-cita">Recoger en tienda</button>
                <button id="delivery-btn" class="btn-cita">Servicio a Domicilio</button>
            </div>
        </div>
    </div>

    <!-- Estructura del Modal de Cantidad (Oculto por defecto) -->
    <div id="quantity-modal" class="modal-overlay">
        <div class="modal-content" style="max-width: 350px;">
            <span class="close-modal">&times;</span>
            <h2 id="quantity-modal-title">Seleccionar Cantidad</h2>
            <form id="form-quantity" class="form-container">
                <div class="form-group">
                    <label>Cantidad</label>
                    <div class="quantity-selector">
                        <button type="button" class="quantity-btn" id="quantity-minus">-</button>
                        <input type="text" id="quantity-input" value="1" min="1" readonly>
                        <button type="button" class="quantity-btn" id="quantity-plus">+</button>
                    </div>
                </div>
                <button type="submit" class="btn-enviar">Aceptar</button>
            </form>
        </div>
    </div>

    <!-- Estructura del Modal de Servicio a Domicilio (Oculto por defecto) -->
    <div id="delivery-modal" class="modal-overlay">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close-modal">&times;</span>
            <h2>Datos de Entrega</h2>
            <p class="subtitulo-catalogo" style="margin-bottom: 1rem;">Ingresa tus datos para el envío.</p>
            <form id="form-delivery" class="form-container" style="text-align: left;">
                <div class="form-group">
                    <label for="delivery-nombre">Nombre de quien recibe</label>
                    <input type="text" id="delivery-nombre" required
                           minlength="3" maxlength="50"
                           pattern="[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+"
                           title="Solo letras, mínimo 3 caracteres"
                           placeholder="Ej: Juan Pérez">
                </div>
                <div class="form-group">
                    <label for="delivery-calle">Calle</label>
                    <input type="text" id="delivery-calle" required
                           minlength="3" maxlength="100"
                           title="Mínimo 3 caracteres"
                           placeholder="Ej: Av. Reforma">
                </div>
                <div class="form-group">
                    <label for="delivery-colonia">Colonia</label>
                    <select id="delivery-colonia" required title="Selecciona una colonia">
                        <option value="">-- Selecciona una colonia --</option>
                        <option value="Aeropuerto">Aeropuerto</option>
                        <option value="Alamedas">Alamedas</option>
                        <option value="Altavista">Altavista</option>
                        <option value="Ávalos">Ávalos</option>
                        <option value="Barrio San Pedro">Barrio San Pedro</option>
                        <option value="Bellavista">Bellavista</option>
                        <option value="Cafetales">Cafetales</option>
                        <option value="Campanario">Campanario</option>
                        <option value="Campesina">Campesina</option>
                        <option value="Campobello">Campobello</option>
                        <option value="Centro">Centro</option>
                        <option value="Cerradas de Cumbres">Cerradas de Cumbres</option>
                        <option value="Chihuahua 2000">Chihuahua 2000</option>
                        <option value="Club Campestre">Club Campestre</option>
                        <option value="Colinas del Sol">Colinas del Sol</option>
                        <option value="Cumbres">Cumbres</option>
                        <option value="Cumbres del Sur">Cumbres del Sur</option>
                        <option value="Dale">Dale</option>
                        <option value="Delicias">Delicias</option>
                        <option value="Diego Lucero">Diego Lucero</option>
                        <option value="El Palomar">El Palomar</option>
                        <option value="Francisco I. Madero">Francisco I. Madero</option>
                        <option value="Granjas">Granjas</option>
                        <option value="Guadalupe">Guadalupe</option>
                        <option value="Independencia">Independencia</option>
                        <option value="Industrial">Industrial</option>
                        <option value="Jardines del Santuario">Jardines del Santuario</option>
                        <option value="Josefa Ortiz de Dominguez">Josefa Ortiz de Dominguez</option>
                        <option value="Kennedy">Kennedy</option>
                        <option value="La Cantera">La Cantera</option>
                        <option value="Las Granjas">Las Granjas</option>
                        <option value="Lomas">Lomas</option>
                        <option value="Lomas del Santuario">Lomas del Santuario</option>
                        <option value="Los Nogales">Los Nogales</option>
                        <option value="Mármol">Mármol</option>
                        <option value="Martín López">Martín López</option>
                        <option value="Mirador">Mirador</option>
                        <option value="Nombre de Dios">Nombre de Dios</option>
                        <option value="Obrera">Obrera</option>
                        <option value="Pacífico">Pacífico</option>
                        <option value="Palmas">Palmas</option>
                        <option value="Panamericana">Panamericana</option>
                        <option value="Parques de San Felipe">Parques de San Felipe</option>
                        <option value="Paseos de Chihuahua">Paseos de Chihuahua</option>
                        <option value="Pinos">Pinos</option>
                        <option value="Ponce de León">Ponce de León</option>
                        <option value="Quintas Carolinas">Quintas Carolinas</option>
                        <option value="Quintas del Sol">Quintas del Sol</option>
                        <option value="Revolución">Revolución</option>
                        <option value="Riberas de Sacramento">Riberas de Sacramento</option>
                        <option value="Rosario">Rosario</option>
                        <option value="Sacramento">Sacramento</option>
                        <option value="San Felipe Viejo">San Felipe Viejo</option>
                        <option value="San Francisco">San Francisco</option>
                        <option value="San José">San José</option>
                        <option value="San Miguel">San Miguel</option>
                        <option value="San Rafael">San Rafael</option>
                        <option value="Santa Rita">Santa Rita</option>
                        <option value="Santa Rosa">Santa Rosa</option>
                        <option value="Santo Niño">Santo Niño</option>
                        <option value="Saucito">Saucito</option>
                        <option value="Sector Bolívar">Sector Bolívar</option>
                        <option value="Tecnológico">Tecnológico</option>
                        <option value="Tierra y Libertad">Tierra y Libertad</option>
                        <option value="Unidad Chihuahua">Unidad Chihuahua</option>
                        <option value="Valle de la Madrid">Valle de la Madrid</option>
                        <option value="Valle del Sol">Valle del Sol</option>
                        <option value="Villa">Villa</option>
                        <option value="Vistas del Norte">Vistas del Norte</option>
                        <option value="Zootecnia">Zootecnia</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="delivery-numero">Número Exterior</label>
                    <input type="text" id="delivery-numero" required
                           minlength="1" maxlength="10"
                           pattern="[0-9A-Za-z\-]+"
                           title="Número válido (puede incluir letras, ej: 123-A)"
                           placeholder="Ej: 456">
                </div>
                <button type="submit" class="btn-enviar">Confirmar Pedido</button>
            </form>
        </div>
    </div>

    <!-- Estructura del Modal de Alerta Genérico (Oculto por defecto) -->
    <div id="alert-modal" class="modal-overlay">
        <div class="modal-content" style="max-width: 400px;">
            <h2 id="alert-modal-title">Aviso</h2>
            <p id="alert-modal-message" class="subtitulo-catalogo" style="margin-bottom: 1.5rem;"></p>
            <button id="alert-modal-close" class="btn-cita">Aceptar</button>
        </div>
    </div>

</body>
</html>
